' Gambas class file

'#################################################
' Software sotto licenza GPL v3 o superiore
' Software under GPL v3 o more licence
' Francesco "Ceskho OpenCode" Apruzzese
' per info o segnalazioni scrivere a :
' cescoap@gmail.com
'#################################################

PUBLIC SUB Form_Open()

  ME.Center

  '-- gestisce le colonne
  GridView1.Columns.Count = 2
  GridView1.Columns[0].Text = "Parola"
  GridView1.Columns[0].W = 2 * (GridView1.w / 3)
  GridView1.Columns[1].Text = "Numero"

END

PUBLIC SUB cerca_Click()

  DIM testo AS String
  DIM actual AS String
  DIM i AS Integer
  DIM j AS Integer = 0

  '-- pulisce la gridview
  GridView1.Rows.Count = 0

  '-- not run the sub if textarea in empty or if is a number
  IF (txtcerca.Text = "" OR IsDigit(txtcerca.Text)) THEN RETURN
  '-- not run the sub if the first char in textarea isn't a letter
  IF NOT (LCase$(Left$(txtcerca.Text)) LIKE "[a-z]") THEN RETURN 

  IF NOT Exist(Application.Path &/ "smorfia/" & LCase$(Left$(txtcerca.Text))) THEN RETURN 

  testo = File.Load(Application.Path &/ "smorfia/" & LCase$(Left$(txtcerca.Text)))
  '-- scorre tutto il resto riga per riga
  FOR i = 0 TO Split(testo, "\n").Length - 1
    actual = Split(testo, "\n")[i]
    '-- se il testo cercato Ã¨ contenuto nel cerco della smorfia lo mostra
    IF Left$(LCase$(txtcerca.Text), Len(txtcerca.Text)) = Left$(actual, Len(txtcerca.text)) THEN
      INC GridView1.Rows.Count
      GridView1[j, 0].Text = Split(actual, "#")[0]
      GridView1[j, 1].Text = Split(actual, "#")[1]
      INC j
    END IF
  NEXT

END
