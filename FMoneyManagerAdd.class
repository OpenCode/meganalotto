' Gambas class file

'#################################################
' Software sotto licenza GPL v3 o superiore
' Software under GPL v3 o more licence
' Francesco "Ceskho OpenCode" Apruzzese
' per info o segnalazioni scrivere a :
' cescoap@gmail.com
'#################################################

PUBLIC SUB Form_Open()

  ME.Center
  Label1.Text = Management.$value
  Label2.Text = Management.$value

END

PUBLIC SUB btSave_Click()

  DIM $hConn AS NEW Connection
  DIM sql AS String
  DIM hres AS Result
  
  WITH $hConn
  .Type = Management.DatabaseType
  .Host = Management.DatabasePath
  END WITH

  $hConn.Name = Management.DatabaseName
  $hConn.Open

  $hconn.Begin

  hres = $hconn.Create(Management.DatabaseTableName)  'collega il result hres alla tavola prova in modalit√† creazione record

  hres!data = CInt(Replace(Str(DateChooser1.Value), "/", ""))
  hres!used = Str(ValueBox1.Value)
  hres!win = Str(ValueBox2.Value)
  hres!note = TextArea1.Text

  hres.Update

  $hConn.Commit
  $hConn.Close
  
  ME.Close

END

PUBLIC SUB btClose_Click()

  ME.Close

END
